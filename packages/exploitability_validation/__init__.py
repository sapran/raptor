"""
Exploitability Validation Package

Multi-stage pipeline for validating vulnerability findings are real, reachable, and exploitable.

Usage:
    from packages.exploitability_validation import run_validation, build_checklist

    # Run full pipeline
    result = run_validation(
        target_path="/path/to/code",
        vuln_type="command_injection"
    )

    # Or build checklist only (Stage 0)
    checklist = build_checklist("/path/to/code", "/path/to/output")

    # Validate JSON outputs
    from packages.exploitability_validation import validate_checklist, validate_findings
    is_valid, errors = validate_checklist(checklist_data)
"""

from .orchestrator import (
    run_validation,
    ValidationOrchestrator,
    PipelineConfig,
    PipelineState,
    Stage,
    StageStatus,
    StageResult,
    MEMORY_CORRUPTION_TYPES,
)

from .schemas import (
    validate_checklist,
    validate_findings,
    validate_attack_tree,
    validate_attack_paths,
    validate_attack_surface,
    create_empty_checklist,
    create_empty_findings,
    create_finding,
    ValidationError,
    CHECKLIST_SCHEMA,
    FINDINGS_SCHEMA,
    FINDING_SCHEMA,
    ATTACK_TREE_SCHEMA,
    ATTACK_PATH_SCHEMA,
    ATTACK_SURFACE_SCHEMA,
)

from .checklist_builder import (
    build_checklist,
    extract_functions,
    detect_language,
    update_checklist_coverage,
    get_coverage_stats,
    DEFAULT_EXCLUDES,
    LANGUAGE_MAP,
)

from .agentic import (
    run_validation_phase,
    convert_sarif_to_findings,
    classify_vuln_type,
    VULN_TYPE_MAP,
)

__all__ = [
    # Orchestrator
    'run_validation',
    'ValidationOrchestrator',
    'PipelineConfig',
    'PipelineState',
    'Stage',
    'StageStatus',
    'StageResult',
    'MEMORY_CORRUPTION_TYPES',

    # Schemas
    'validate_checklist',
    'validate_findings',
    'validate_attack_tree',
    'validate_attack_paths',
    'validate_attack_surface',
    'create_empty_checklist',
    'create_empty_findings',
    'create_finding',
    'ValidationError',
    'CHECKLIST_SCHEMA',
    'FINDINGS_SCHEMA',
    'FINDING_SCHEMA',
    'ATTACK_TREE_SCHEMA',
    'ATTACK_PATH_SCHEMA',
    'ATTACK_SURFACE_SCHEMA',

    # Checklist Builder
    'build_checklist',
    'extract_functions',
    'detect_language',
    'update_checklist_coverage',
    'get_coverage_stats',
    'DEFAULT_EXCLUDES',
    'LANGUAGE_MAP',

    # Agentic Integration
    'run_validation_phase',
    'convert_sarif_to_findings',
    'classify_vuln_type',
    'VULN_TYPE_MAP',
]

__version__ = '1.0.0'
