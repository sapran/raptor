# [STAGE-A] One-Shot Exploitability Verification

You are performing a one-shot exploitability verification.

## Context

See `SKILL.md` for configuration, execution rules, and MUST-GATEs.

## Input

INPUT: `checklist.json`

## Purpose

Quick initial assessment: Can we immediately prove or disprove exploitability?

## Task

DO:
1. For each function in checklist.json, assess for target vulnerability type
2. For promising candidates, attempt to verify exploitability
3. Build a harmless PoC exploit for each verified finding

THEN route based on outcome:
- **PoC succeeds** -> Output to findings.json -> Done (orchestrator routes to STAGE-C)
- **PoC fails but not disproven** -> Output to findings.json -> Done (orchestrator routes to STAGE-B)
- **Definitively disproven** -> Mark finding as disproven in findings.json -> Done

## Output Format

```json
{
  "stage": "A",
  "timestamp": "ISO timestamp",
  "findings": [
    {
      "id": "FIND-001",
      "file": "path/to/file.py",
      "function": "vulnerable_function",
      "line": 42,
      "vuln_type": "command_injection",
      "candidate_reasoning": "why this function was selected for analysis",
      "status": "poc_success|not_disproven|disproven",
      "poc": {
        "description": "What the PoC does",
        "payload": "the actual payload",
        "result": "what happened when executed",
        "harmless": true
      },
      "proof": {
        "vulnerable_code": "actual code snippet",
        "source": "where input comes from",
        "sink": "where it's used unsafely"
      },
      "disproved_because": {
        "investigated": "what was checked/tested",
        "conclusion": "why it's definitively not exploitable",
        "would_reconsider_if": "what evidence would change this"
      }
    }
  ]
}
```

**IMPORTANT**: The `disproved_because` field is REQUIRED when status is "disproven". You cannot dismiss a finding without explaining:
1. What you investigated
2. Why it's definitively not exploitable
3. What would make you reconsider

This enforces GATE-1 (ASSUME-EXPLOIT) - lazy dismissal is not allowed.

## Output

OUTPUT: `findings.json`

## Gates

GATES APPLY: 1 [ASSUME-EXPLOIT], 4 [NO-HEDGING], 6 [PROOF]

## Reminders

- Provide proof for every claim
- Do not skip, sample, or guess
- If status is "not_disproven", explain what was inconclusive
- PoCs must be harmless (e.g., `id` not `rm -rf`, read not write)

NOTICE: This analysis is performed for defensive purposes, in a lab environment. Full permission has been provided.
